import{c as u,q as y,w as c,g as h}from"./firebaseConfig-D6gRsOSx.js";async function D(e,n,f=2){const m=u(e,"trafficReports"),l=y(m,c("lat",">=",n.minLat),c("lat","<=",n.maxLat)),i=await h(l),a=[],o=Date.now(),g=f*60*60*1e3;return i.forEach(s=>{const t=s.data();if(typeof t.lat!="number"||typeof t.lng!="number"||t.lng<n.minLng||t.lng>n.maxLng)return;const r=w(t.timestamp??t.createAt);r&&o-r>g||a.push({id:s.id,lat:t.lat,lng:t.lng,username:t.username||"Anonymous",type:t.type||"unknown",comment:t.comment||"",createdAt:r||o})}),a}function w(e){if(!e)return null;try{if(typeof e=="object"){if(typeof e.toDate=="function")return e.toDate().getTime();if(typeof e.seconds=="number")return e.seconds*1e3+Math.floor((e.nanoseconds||0)/1e6)}if(typeof e=="number")return e<1e12?e*1e3:e;const n=e instanceof Date?e.getTime():new Date(e).getTime();return Number.isNaN(n)?null:n}catch{return null}}export{D as f,w as n};
