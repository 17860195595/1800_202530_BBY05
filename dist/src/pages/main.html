<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <!-- Load Leaflet first as it's needed by main.js -->
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
    <!-- Then load our modules -->
    <script type="module" crossorigin src="/assets/mainPage-B0PmEbLT.js"></script>
    <link rel="modulepreload" crossorigin href="/assets/modulepreload-polyfill-B5Qt9EMX.js">
    <link rel="modulepreload" crossorigin href="/assets/components-9bzrBSqj.js">
    <link rel="modulepreload" crossorigin href="/assets/vendor-DQ-sQAqT.js">
    <link rel="modulepreload" crossorigin href="/assets/firebaseConfig-D6gRsOSx.js">
    <link rel="modulepreload" crossorigin href="/assets/trafficService-DxV7s4Yh.js">
    <link rel="stylesheet" crossorigin href="/assets/components-eapcKjT8.css">
    <link rel="stylesheet" crossorigin href="/assets/main-De9yT8e5.css">
  </head>
  <body>
    <app-navbar></app-navbar>
    <!-- alert message box -->
    <div id="welcomeBox" class="alert d-none" role="alert">
      <span id="welcomeMsg"></span>
      <div id="welcomeActions">
        <button id="loginRedirectBtn" class="login-btn" style="display: none">
          Login
        </button>
        <span id="closeWelcomeBox">&times;</span>
      </div>
    </div>
    <div class="container main-container">
      <h1 id="welcomeTitle"></h1>
      <app-search-bar></app-search-bar>

      <!-- Report Button -->
      <div class="report-section">
        <button id="reportBtn" class="report-btn">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              d="M9 11H5a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2h-4M9 7l5-5 5 5M15 2v12"
            />
          </svg>
          Report Traffic
        </button>
      </div>
    </div>

    <!-- Traffic Jam Alert Block -->
    <div id="trafficJamAlert" class="traffic-jam-alert">
      <div class="traffic-jam-header">
        <div class="traffic-jam-icon">
          <svg
            width="30"
            height="30"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"
            ></path>
            <line x1="12" y1="9" x2="12" y2="13"></line>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
        </div>
        <div class="traffic-jam-title">
          <h2>Nearby Traffic Alerts</h2>
          <div class="traffic-jam-subtitle-wrapper">
            <p class="traffic-jam-subtitle" id="trafficJamSubtitle">
              Within 5km radius
            </p>
            <div class="traffic-jam-distance-filter">
              <label for="distanceFilter" class="filter-label">Distance:</label>
              <select id="distanceFilter" class="distance-select">
                <option value="1">1 km</option>
                <option value="3">3 km</option>
                <option value="5" selected>5 km</option>
                <option value="10">10 km</option>
                <option value="20">20 km</option>
              </select>
            </div>
          </div>
        </div>
        <div class="traffic-jam-count" id="trafficJamCount">
          <span class="count-number">0</span>
          <span class="count-label">reports</span>
        </div>
      </div>
      <div class="traffic-jam-content" id="trafficJamContent">
        <div class="traffic-jam-loading">
          <div class="loading-spinner"></div>
          <p>Loading nearby traffic information...</p>
        </div>
      </div>
    </div>

    <!-- Map -->
    <div id="map"></div>

    <!-- Traffic Detail Modal -->
    <div class="traffic-detail-modal" id="trafficDetailModal">
      <div class="traffic-detail-content">
        <div class="traffic-detail-header">
          <h3>Traffic Details</h3>
          <button class="traffic-close-btn" id="trafficCloseBtn">
            &times;
          </button>
        </div>
        <div class="traffic-detail-body">
          <!-- user report information -->
          <div class="traffic-status-item">
            <span class="traffic-label">User:</span>
            <span class="traffic-value" id="trafficReporterName">-</span>
          </div>
          <div class="traffic-status-item">
            <span class="traffic-label">Type:</span>
            <span class="traffic-value" id="trafficReportType">-</span>
          </div>
          <div class="traffic-status-item">
            <span class="traffic-label">Comment:</span>
            <span class="traffic-value" id="trafficReportComment">-</span>
          </div>
          <div class="traffic-status-item">
            <span class="traffic-label">Published:</span>
            <span class="traffic-value" id="trafficReportTime">â€”</span>
          </div>
        </div>
      </div>
    </div>

    <!-- footer -->
    <app-footer></app-footer>
  </body>
</html>
